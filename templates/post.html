{% extends "base.html" %}
{% block content %}
{% load crispy_forms_tags %}
{% load cloudinary %}
<h1 class="display-1 title-style">Adventure: {{ adventure.name }}</h1>
<h2 class="display-1">Destinations:</h2>
{% for post in posts %}
<div class="card  container-sm destination-card">
  {% if "placeholder" in post.featured_image.url %}
  <img src="https://res.cloudinary.com/djs04srkx/image/upload/v1689779280/samples/balloons.jpg">
  {% else %}
  <img src=" {{ post.featured_image.url }}">
  {% endif %}
    <div class="card-body">
      <h5 class="card-title display-6">{{ post.title }}</h5>
      <p class="card-text">{{ post.content }}</p>
    </div>
    <ul class="list-group list-group-flush">
      <li class="list-group-item">Destination Created: {{ post.created_on }}</li>
      <li class="list-group-item">Destination Updated: {{ post.updated_on }}</li>
    </ul>
    <div class="card-buttons d-flex justify-content-evenly align-items-center">
    {% if perms.blog.edit_post %}
      <a href="{% url 'edit_post' post.id adventure.id user.id %}" class="card-link"><i class="fa-solid fa-pen-to-square"></i></a>
      {% endif %}
    {% if perms.blog.delete_post %}
      <a onclick="return confirm('Are you sure you want to delete {{ post.title }}?')" href="{% url 'delete_post' post.id adventure.id user.id %}" class="card-link"><i class="fa-solid fa-trash"></i></a>
    {% endif %}
    </div>
    </div>
  </div>
{% empty %}
        <tr><td>You have no Destinations planed.</td></tr>  
{% endfor %}
<h4>Comments: </h4>
{% for comment in comments %}
<div class="card container-fluid container-sm">
    <div class="card-body text-center">
        <figure>
            <blockquote class="blockquote">
            <p>{{ comment.body }}</p>
            </blockquote>
            <figcaption class="blockquote-footer">
            {{ comment.name}}
            </figcaption>
        </figure>
    </div>
</div>
{% endfor %}

<div class="d-flex justify-content-end justify-content-around" >
  {% if perms.blog.add_comment%}
<a href="/add_comment/{{ adventure.id }}/{{ user.id }}" class="card-link"><button type="button" class="btn btn-success">Add Comment<i class="fa-solid fa-comments"></i></button></a>
  {% endif %}
</div>

{% if perms.blog.add_post %}
<button type="submit" class="btn btn-success" id="addPostBtn">Add Post</button>
{% endif %}
<div id="addPostModal">
  <h3 class="display-1">Add Post</h3>
  <form method="POST" class="container" style="width: 50%;" enctype="multipart/form-data">
      {{ post_form|crispy }}
      {% csrf_token %}
      <button type="submit" class="btn btn-success close">Add</button>
  </form>
</div>

{% endblock %}